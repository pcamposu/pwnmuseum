<%# Timeline Event Card with Click to Open Modal %>
<div id="exploit_<%= exploit.id %>" class="relative group cursor-pointer flex-shrink-0 snap-center"
    style="min-width: 180px; width: 280px;">

  <%= link_to platform_exploit_path(platform_slug: @platform.slug, id: exploit.id),
      data: { turbo_stream: true },
      class: "block" do %>

    <!-- Timeline Dot with Glow Effect -->
    <div class="w-6 h-6 sm:w-8 sm:h-8 rounded-full border-3 sm:border-4 border-gray-950 relative z-10 mx-auto flex-shrink-0 transition-all duration-300 group-hover:scale-110
        <%= 'bg-red-500 shadow-xl shadow-red-500/70 ring-3 sm:ring-4 ring-red-500/30' if exploit.impact_level_bootrom? %>
        <%= 'bg-orange-500 shadow-lg shadow-orange-500/50 ring-2 sm:ring-2 ring-orange-500/20' if exploit.impact_level_hypervisor? %>
        <%= 'bg-yellow-500 shadow-md shadow-yellow-500/40' if exploit.impact_level_kernel_mode? %>
        <%= 'bg-green-500 shadow-md shadow-green-500/40' if exploit.impact_level_user_mode? %>">
    </div>

    <!-- Compact Card (Always Visible) -->
    <div class="absolute top-8 sm:top-10 left-1/2 -translate-x-1/2 w-40 sm:w-48 md:w-52 bg-gray-900 border-2 border-gray-700 rounded-xl p-3 sm:p-4 group-hover:border-red-500 group-hover:shadow-xl group-hover:shadow-red-900/40 group-hover:-translate-y-1 transition-all duration-300 mx-2 sm:mx-0">
      <div class="flex items-center gap-2 mb-2">
        <h3 class="font-mono font-bold text-sm sm:text-base text-white truncate flex-1"><%= exploit.title %></h3>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4 text-gray-500 group-hover:text-red-400 transition-colors flex-shrink-0">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
        </svg>
      </div>
      <p class="text-xs text-gray-400 font-mono mb-2 sm:mb-3">
        <%= exploit.date_discovered.strftime("%b %Y") %>
      </p>
      <span class="inline-block px-2 sm:px-3 py-1 rounded-full text-xs font-mono font-bold uppercase tracking-wide
          <%= 'bg-red-500/30 text-red-300 border border-red-500/50' if exploit.impact_level_bootrom? %>
          <%= 'bg-orange-500/30 text-orange-300 border border-orange-500/50' if exploit.impact_level_hypervisor? %>
          <%= 'bg-yellow-500/30 text-yellow-300 border border-yellow-500/50' if exploit.impact_level_kernel_mode? %>
          <%= 'bg-green-500/30 text-green-300 border border-green-500/50' if exploit.impact_level_user_mode? %>">
        <%= exploit.impact_level.to_s.humanize %>
      </span>

      <% if exploit.media_url.present? %>
        <div class="mt-2 flex items-center gap-1 text-xs text-red-400 font-mono">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125M3.375 19.5h1.5C5.496 19.5 6 18.996 6 18.375m-3.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v1.5" />
          </svg>
          <span>Video</span>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
